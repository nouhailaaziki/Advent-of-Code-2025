def count_timelines(grid):
    rows = len(grid)
    cols = len(grid[0])

    dp = [[0] * cols for _ in range(rows)]

    for r in range(rows):
        for c in range(cols):
            if grid[r][c] == 'S':
                dp[r][c] = 1
                break

    for r in range(rows - 1):
        for c in range(cols):
            if dp[r][c] == 0:
                continue
            cell = grid[r][c]
            if cell == '.' or cell == 'S' or cell == '|':
                dp[r + 1][c] += dp[r][c]
            elif cell == '^':
                if c - 1 >= 0:
                    dp[r + 1][c - 1] += dp[r][c]
                if c + 1 < cols:
                    dp[r + 1][c + 1] += dp[r][c]

    return sum(dp[rows - 1])


manifold = [
	"......................................................................S......................................................................",
	".............................................................................................................................................",
	"......................................................................^......................................................................",
	".............................................................................................................................................",
	".....................................................................^.^.....................................................................",
	".............................................................................................................................................",
	"....................................................................^...^....................................................................",
	".............................................................................................................................................",
	"...................................................................^.^.^.^...................................................................",
	".............................................................................................................................................",
	"..................................................................^.^.^.^.^..................................................................",
	".............................................................................................................................................",
	".................................................................^.^.^.^.^.^.................................................................",
	".............................................................................................................................................",
	"................................................................^.^.^.....^.^................................................................",
	".............................................................................................................................................",
	"...............................................................^.^.^.^...^.^.^...............................................................",
	".............................................................................................................................................",
	"..............................................................^.^.^...^...^.^.^..............................................................",
	".............................................................................................................................................",
	".............................................................^...^.....^...^.^.^.............................................................",
	".............................................................................................................................................",
	"............................................................^.^.....^.^...^.^.^.^............................................................",
	".............................................................................................................................................",
	"...........................................................^.^...^...^.^.^.^.^.^.^...........................................................",
	".............................................................................................................................................",
	"..........................................................^.^...^.^.^.^.^.^.^.^.^.^..........................................................",
	".............................................................................................................................................",
	".........................................................^.^.^.^.....^.^.^.^.....^.^.........................................................",
	".............................................................................................................................................",
	"........................................................^.^.^.^.....^.^.^.^.^.....^.^........................................................",
	".............................................................................................................................................",
	".......................................................^.^.^.^.^.^.^.^.^...^.....^...^.......................................................",
	".............................................................................................................................................",
	"......................................................^.^...^...^.....^...^...^.^.....^......................................................",
	".............................................................................................................................................",
	".....................................................^.^.^...^.^.....^.^.^.^...^.^.^.^.^.....................................................",
	".............................................................................................................................................",
	"....................................................^.^.^.^...^.^.^.^.............^.^.^.^....................................................",
	".............................................................................................................................................",
	"...................................................^.^.^.^.^.^...^.^.^.^.....^.^.^.^.^.^.^...................................................",
	".............................................................................................................................................",
	"..................................................^...^...^.....^.......^.^.^...^...^.^.^.^..................................................",
	".............................................................................................................................................",
	".................................................^...^...^.^.^.^.^...^...........^.^.^.....^.................................................",
	".............................................................................................................................................",
	"................................................^.^.^.^.^.^.^.^...^...^...^...^.^.^.....^.^.^................................................",
	".............................................................................................................................................",
	"...............................................^.^...^.^...^.^.^...^...^.^.....^.^.^.^.^.....^...............................................",
	".............................................................................................................................................",
	"..............................................^.^.^.^.^.^...^...^...^.^.^.^...^.^.^.^.......^.^..............................................",
	".............................................................................................................................................",
	".............................................^.^.^.^...^.^.^.^...^.^...^...^...^...^.....^.^.^.^.............................................",
	".............................................................................................................................................",
	"............................................^.^...^...^.^.^.^...^...^.^.^.^.^.^...^.^.^.^.^.^.^.^............................................",
	".............................................................................................................................................",
	"...........................................^.^...^.^.^.^.^.^...^...^...^...^...^.^...^.^.^.^...^.^...........................................",
	".............................................................................................................................................",
	"..........................................^.^.^...^.^.^.^...^.^.^.^...^...^.^.^.^.^.^...^.^.^.^.^.^..........................................",
	".............................................................................................................................................",
	".........................................^.^.......^...^.....^...^.^.^.^.^.^.^.^.^...^.^.^...^.^.^.^.........................................",
	".............................................................................................................................................",
	"........................................^.^...^.^...^...^.^.^.^.^.....^.....^.^.^.^.^.....^...^.^...^........................................",
	".............................................................................................................................................",
	".......................................^.^.^.^.^.^.^.^.^.^.^...^...^.^...^.^...^...^.^.......^.....^.^.......................................",
	".............................................................................................................................................",
	"......................................^...^.^.^.^.....^...^.........^.^...^.^.^...^.^...^.^.^.^.^.^...^......................................",
	".............................................................................................................................................",
	".....................................^.^...^.^.^.^.......^.^.....^.^.^.^.^.^.^...^.^.....^.....^.^...^.^.....................................",
	".............................................................................................................................................",
	"....................................^...^...^.....^...^.^.^...^.^.^.^.^.^.^.......^.....^.^.^.^...^...^.^....................................",
	".............................................................................................................................................",
	"...................................^.^.^.^...^...^.^...^.^.^...^.....^.^...^.^...^.^.^...^...^.^.^.^.^...^...................................",
	".............................................................................................................................................",
	"..................................^.^.^.^.^...^.^.^.^.^.^.^.^...^...^...^.^.....^.^.^...^.^...^.^.....^.^.^..................................",
	".............................................................................................................................................",
	".................................^...^.........^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.......^.^.^.....^.^.^.^.................................",
	".............................................................................................................................................",
	"................................^.^.^...^...^...^.^.^.^...^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.^.^................................",
	".............................................................................................................................................",
	"...............................^.^...^.^.^.^.^.^...^.^.^...^...^...^.^.^.....^...^...^.^.....^.^...^.^.....^.^...............................",
	".............................................................................................................................................",
	"..............................^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^...^.^.^.^.^.^.^...^...^.....^.....^.....^..............................",
	".............................................................................................................................................",
	".............................^.^.^.^.^.^.^...^.^.^.^.^.....^.^.^.....^.^.^.^.....^...^...^.^.^...^.^.^.^.....^.^.............................",
	".............................................................................................................................................",
	"............................^.^...^.^.^.^.^.^.^.^...^...^.^.^.^.^.....^.^.^.^.^...^.^.^.^...^.^.^...^...^.^.^...^............................",
	".............................................................................................................................................",
	"...........................^...^...^.^...^.^.^...^.^...^.......^...^...^.^...^.^.^...^.^...^.^...^.^...^.^...^.^.^...........................",
	".............................................................................................................................................",
	"..........................^.^...^.^...^.^...^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.........^...^.^...^.....^...^.^...^.^..........................",
	".............................................................................................................................................",
	".........................^.^.^.^.^...^.^.^.....^.^.......^.^.^...^...^.^...^.......^.^.^...^.^.^.....^.^.^.^.^.^...^.........................",
	".............................................................................................................................................",
	"........................^.^.....^...^.^.^...^.^...^...^.^.^.^.^...^.^.^...^.^.^.^...^.^.....^.^.^.^.^.^...^.....^.^.^........................",
	".............................................................................................................................................",
	".......................^.^...^.^...^.^.^.^.....^...^...^...^.....^.^...^.^...^...^.^.^.^.^.^...^.......^.^.^.^.^...^.^.......................",
	".............................................................................................................................................",
	"......................^.^.^.....^...^...^.^.^.^.....^.^...^.^.^.^.^...^...^.......^.^.^.^.........^.....^.^.^...^.^...^......................",
	".............................................................................................................................................",
	".....................^.^.^.....^...^.....^.^...^...^.....^.....^.^.^.^...^.^...^.^.^...^.^.^.^.^.^.^...^...^.^.^.^.....^.....................",
	".............................................................................................................................................",
	"....................^.^.......^.^.^.....^...^...^...^.^.^.^.^...^.^...^.....^.^.^.^.^.....^...^.^...^.^.....^.^...^.^.^.^....................",
	".............................................................................................................................................",
	"...................^...^.^.^.^.^.^.....^...^.^.^.^.^.....^...^...^.^.^.^...^.........^.^.....^...^...^.^.^.......^.^.^.^.^...................",
	".............................................................................................................................................",
	"..................^.^.^.^.......^.^.^.^.^...^.^...^...^.^.......^.^.^.^.^.^...^.^.^.^.^...^.^.^...^.^.^...^.^...^.^.....^.^..................",
	".............................................................................................................................................",
	".................^.^...^.^.^.^.^...^.^.^.......^.^.^...^.^.^...^.^.^.^.^.^.^.^.....^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^...^.^.................",
	".............................................................................................................................................",
	"................^...^.^.^...^.^.....^.^.^.^.^.^.^.^.^.^...^.^.^...^...^.......^...^.^.^.^.^...^...^.^.^...^...^...^.^.......^................",
	".............................................................................................................................................",
	"...............^.^.^...^.^.^.^.^.......^.^.^.^.^.^.^...^.^.^.^.^.^.^.......^.......^.....^.^.^...^...^...^...^.^.^.^.^.^.^.^.^...............",
	".............................................................................................................................................",
	"..............^...^.^.^...^.^.^.^.......^.....^.^...^.^.^.^.^.^.^.^...^.................^.^.^.^...^.^.^.^.......^.^.^...^...^.^..............",
	".............................................................................................................................................",
	".............^.^.^.^.........^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...^.^.^.^.^.^.^.^.^.......^.^.^.^.^.^...^.^...^.^.^.^...^.^.^.^.............",
	".............................................................................................................................................",
	"............^.^.^.^...^.^...^.^...^.^...^.^.^.^...^.......^.^...^...^.^...^.^...^...^.^.^.^...^.......^.^...^...^.......^.^.^.^.^............",
	".............................................................................................................................................",
	"...........^...^.^.^.^.^.^.^.^.^.^.^.^.^...^...^.^.....^...^.....^.^.^.^.^.^.^.^.....^.....^.^.^.^.^.^.^.^.^...^...^.^.....^.^.^.^...........",
	".............................................................................................................................................",
	"..........^.^...^.^.....^...^.^.^.^...^.^.^.^.^.^...^.^...^.^.......^.....^.........^.^.^.......^...^.^.^.......^...^.^...^.^.^.^.^..........",
	".............................................................................................................................................",
	".........^.^.^.^.^...^...^.^.......^.^.^.^.^.^...^.^.^.^.^.^.^...^...^...^.^.^.^.....^.^.^.^...^.^.^...^.^.^.^.^.^...^.^.^.....^...^.........",
	".............................................................................................................................................",
	"........^.^.........^.^.^...^.^.....^.....^.^.^.^.^.^.....^...^.^.^.^.......^...^...^.^.^.....^...^.^.^.^.^.....^.^.^.^.^.^...^...^.^........",
	".............................................................................................................................................",
	".......^.^.^.^.^.^.^...^.^...^.^.^.^...^...^...^...^.^...^.^.^.^...^.^...^.....^.^.^...^...^.^.....^.^.^.^.^.....^.....^.^...^.^.^...^.......",
	".............................................................................................................................................",
	"......^...^...^.^.^.^...^.^.^.^.^...^...........^.^.^.^.^.^.^.^.^.^.^.^.^...^.^...^.^...........^.^...............^.^.^.^.^.^.^...^.^.^......",
	".............................................................................................................................................",
	".....^.....^...^.^.^.^.^.^.....^...^...^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.^.^.^.^.^.....^...^.^.^.......^.^.^.^.^.^.^.^.....",
	".............................................................................................................................................",
	"....^.....^.^.^...^...^.^.....^.^.....^...^.^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^...^.^.^.^...^.^...^.^...^...^.^...^...^.^....",
	".............................................................................................................................................",
	"...^.^.^.^.^.^.^.....^...^...^.^.......^.^.^.^.....^.^...^.^.^.^.^...^.^...........^.^.^.^.^...^.^.^...^...^.^.......^.^.^.^.^.^.^.....^.^...",
	".............................................................................................................................................",
	"..^.^.^.^...^.^.^.^.^.^.^.^.....^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.....^.^.^.^.^.^.^.^.........^.^.^.^...^.^.^.^.......^.^.^.^...^...^.....^.^..",
	".............................................................................................................................................",
	".^.^.^.^.^.^.^.^.^...^.^.....^.^.^...^.^.....^...^.^.^...^...^...^.^.^...^.^.^.....^.^...^...^...^...^...^.^.^.^...^.^.^...^.^.^...^...^.^.^.",
	"............................................................................................................................................."
]

print(count_timelines(manifold))


